<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Notarize Document - Blockchain Notary</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üìù Notarize Document</h1>
        <nav class="user-nav">
          <a href="/" class="nav-link">‚Üê Home</a>
          <a href="/verify" class="nav-link">Verify Document</a>
          <span class="user-info">üë§ {{ user_name }}</span>
          <form
            action="{{ url_for('logout') }}"
            method="POST"
            style="display: inline"
          >
            <button type="submit" class="btn btn-logout">Logout</button>
          </form>
        </nav>
      </header>

      <main class="notarize-content">
        <div class="card">
          <div class="alert alert-info" style="margin-bottom: 1.5rem">
            <h3>üîê Document Signature Required</h3>
            <p>
              Documents must be <strong>digitally signed</strong> before
              notarization to prove ownership and document type.
            </p>
            <p style="margin-top: 0.5rem; color: var(--text-muted)">
              Use the standalone signing tool:
              <code>python tools/sign_document.py</code>
            </p>
          </div>

          <div id="walletSection" class="section">
            <h2>Step 1: Connect Wallet</h2>
            <p>Connect your MetaMask wallet to sign the transaction.</p>
            <button id="connectWallet" class="btn btn-primary">
              Connect MetaMask
            </button>
            <div id="walletInfo" class="wallet-info hidden">
              <p>‚úì Connected: <span id="walletAddress"></span></p>
            </div>
          </div>

          <div id="uploadSection" class="section hidden">
            <h2>Step 2: Select Document Type & Upload</h2>
            <form id="notarizeForm" enctype="multipart/form-data">
              <div class="form-group">
                <label for="documentType">Document Type</label>
                <select
                  id="documentType"
                  name="document_type"
                  required
                  class="form-select"
                >
                  <option value="">-- Select Document Type --</option>
                  {% for key, label in document_types.items() %}
                  <option value="{{ key }}">{{ label }}</option>
                  {% endfor %}
                </select>
                <small
                  style="
                    color: var(--text-muted);
                    display: block;
                    margin-top: 0.5rem;
                  "
                >
                  ‚ö†Ô∏è Must match the document type embedded in your signed
                  document
                </small>
              </div>
              <div class="file-input-wrapper">
                <input type="file" id="fileInput" name="file" required />
                <label for="fileInput" class="file-label">
                  <span class="file-icon">üìÅ</span>
                  <span id="fileLabel">Choose a signed document...</span>
                </label>
              </div>
              <button type="submit" class="btn btn-primary">
                Notarize Document
              </button>
            </form>
          </div>

          <div id="verificationSection" class="section hidden">
            <div id="verificationContent"></div>
          </div>

          <div id="processingSection" class="section hidden">
            <div class="loader"></div>
            <p id="processingMessage">Processing...</p>
          </div>

          <div id="resultSection" class="section hidden">
            <div id="resultContent"></div>
          </div>
        </div>

        <div class="info-box">
          <h3>‚ÑπÔ∏è Important Information</h3>
          <ul>
            <li>
              <strong>Signed Documents Required:</strong> Only documents with
              valid signatures can be notarized
            </li>
            <li>
              The signature proves you own the document and verifies the
              document type
            </li>
            <li>Make sure MetaMask is installed and unlocked</li>
            <li>You'll need some test ETH for gas fees (Sepolia testnet)</li>
            <li>The document hash (not the file) is stored on blockchain</li>
            <li>Transaction is permanent and cannot be reversed</li>
            <li>Maximum file size: 16MB</li>
          </ul>
        </div>
      </main>

      <footer>
        <p>&copy; 2024 Blockchain Document Notarization</p>
      </footer>
    </div>

    <script src="{{ url_for('static', filename='js/metamask.js') }}"></script>
  </body>
</html>
